"use strict";const WPFormsBuilderFormLocker=window.WPFormsBuilderFormLocker||function(e,s){const o={scheduling:{start:{$dpicker:s("#wpforms-panel-field-settings-form_locker_schedule_start_date"),$tpicker:s("#wpforms-panel-field-settings-form_locker_schedule_start_time")},end:{$dpicker:s("#wpforms-panel-field-settings-form_locker_schedule_end_date"),$tpicker:s("#wpforms-panel-field-settings-form_locker_schedule_end_time")}}},a={init:function(){s(a.ready)},ready:function(){a.events(),a.conditionals(),a.selectConditionals(),a.emailDropdownToggle(),a.dateTimePicker(),a.scheduleDatetimeEvents()},events:function(){s(e).on("click",".wpforms-panel-field-datetime .wpforms-clear-datetime-field",a.resetDateTimeField),s(e).on("change","#wpforms-panel-field-settings-form_locker_verification, #wpforms-panel-field-settings-form_locker_verification_type",a.selectConditionals),s(e).on("change","#wpforms-panel-field-settings-form_locker_user_entry_limit_enable, #wpforms-panel-field-settings-form_locker_user_entry_restrict_by_email",a.emailDropdownToggle),s(e).on("wpformsSaved",a.requireUserEntryLimitRestrictBy)},resetDateTimeField:function(){var e=s(this).siblings("input");e.prop("_flatpickr")?e.prop("_flatpickr").clear():e.val(""),s(this).hide()},conditionals:function(){void 0!==s.fn.conditions&&s.each([{id:"#wpforms-panel-field-settings-form_locker_verification",hides:"#wpforms-panel-field-settings-form_locker_verification_type-wrap"},{id:"#wpforms-panel-field-settings-form_locker_schedule_enable",hides:"#wpforms-form-locker-schedule-datetime-block,#wpforms-panel-field-settings-form_locker_schedule_message-wrap"},{id:"#wpforms-panel-field-settings-form_locker_user_enable",hides:"#wpforms-panel-field-settings-form_locker_user_message-wrap"},{id:"#wpforms-panel-field-settings-form_locker_entry_limit_enable",hides:"#wpforms-panel-field-settings-form_locker_entry_limit-wrap,#wpforms-panel-field-settings-form_locker_entry_limit_message-wrap"},{id:"#wpforms-panel-field-settings-form_locker_user_entry_limit_enable",hides:"#wpforms-panel-field-settings-form_locker_user_entry_restrict_by_ip-wrap,#wpforms-panel-field-settings-form_locker_user_entry_restrict_by_email-wrap,#wpforms-panel-field-settings-form_locker_user_entry_message_limited-wrap,.wpforms-form-locker-user-entry-container,#wpforms-panel-field-settings-form_locker_user_entry_email_field-wrap"}],function(e,t){s(t.id).conditions({conditions:{element:t.id,type:"checked",operator:"is"},actions:{if:{element:t.hides,action:"show"},else:{element:t.hides,action:"hide"}},effect:"appear"})})},selectConditionals:function(){var e=s("#wpforms-panel-field-settings-form_locker_verification_type"),t=e.find("option");const r=e.val(),i=s("#wpforms-panel-field-settings-form_locker_verification").is(":checked");t.length&&t.each(function(){var e=s(this).val();i&&e===r||s(".wpforms-form-locker-"+e).hide(),i&&e===r&&s(".wpforms-form-locker-"+e).show()})},emailDropdownToggle:function(){var e=s("#wpforms-panel-field-settings-form_locker_user_entry_restrict_by_email"),t=s("#wpforms-panel-field-settings-form_locker_user_entry_email_field-wrap"),r=s("#wpforms-panel-field-settings-form_locker_user_entry_limit_enable").is(":checked");e.length&&(e.is(":checked")&&r?t.show():t.hide())},requireUserEntryLimitRestrictBy:function(){var e,t=s("#wpforms-panel-field-settings-form_locker_user_entry_limit_enable");t&&t.is(":checked")&&(t=s("#wpforms-panel-field-settings-form_locker_user_entry_restrict_by_ip"),e=s("#wpforms-panel-field-settings-form_locker_user_entry_restrict_by_email"),t.is(":checked")||e.is(":checked")||s.alert({title:wpforms_builder.heads_up,content:wpforms_admin_builder_form_locker.require_restrict_user_entry_option,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}))},dateTimePicker:function(){a.datePicker(),a.timePicker(),a.datePair(),a.dateTimeClearBtnsInit()},datePicker:function(){void 0!==s.fn.flatpickr&&(s("#wpforms-panel-field-settings-form_locker_schedule_start_date").flatpickr(a.datePickerGetArgs("start")),s("#wpforms-panel-field-settings-form_locker_schedule_end_date").flatpickr(a.datePickerGetArgs("end")))},timePicker:function(){var e,t,r;void 0!==s.fn.timepicker&&(e={appendTo:s("#wpforms-builder"),disableTextInput:!0,timeFormat:wpforms_admin_builder_form_locker.time_format},t=s("#wpforms-panel-field-settings-form_locker_schedule_start_time"),r=s("#wpforms-panel-field-settings-form_locker_schedule_end_time"),t.timepicker(e).on("selectTime",a.dateTimeClearBtnsRefresh),r.timepicker(e).on("selectTime",a.dateTimeClearBtnsRefresh))},datePair:function(){var e={anchor:null,defaultDateDelta:0,defaultTimeDelta:18e5,dateClass:"wpforms-datepair-date",timeClass:"wpforms-datepair-time",startClass:"wpforms-datepair-start",endClass:"wpforms-datepair-end",parseDate:function(e){return s(e).prop("_flatpickr").selectedDates[0]},updateDate:function(e,t){e=s(e);e.prop("_flatpickr").setDate(t),a.dateTimeClearBtnsRefresh(e),e.trigger("change")},updateTime:function(e,t){e=s(e);e.timepicker("setTime",t),a.dateTimeClearBtnsRefresh(e),e.trigger("change")}};s("#wpforms-form-locker-schedule-datetime-block").datepair(e)},dateTimeClearBtnsInit:function(){s("#wpforms-form-locker-schedule-datetime-block .wpforms-clear-datetime-field").each(function(){var e=s(this);""===e.siblings('[id^="wpforms-panel-field-settings-form_locker_schedule_"]').val()&&e.hide()})},dateTimeClearBtnsRefresh:function(e){(e=e.target?s(e.target):e)&&""!==e.val()&&e.nextAll("button.wpforms-clear-datetime-field").show()},datePickerGetArgs:function(r){r="start"===r?"start":"end";const i=o.scheduling[r].$tpicker,s=o.scheduling[r].$dpicker;var e={altInput:!0,altFormat:wpforms_admin_builder_form_locker.date_format,dateFormat:"Y-m-d",onChange:function(e){var t={field:"start"===r?"end":"start"};t.$dpicker=o.scheduling[t.field].$dpicker,t.$tpicker=o.scheduling[t.field].$tpicker,""===i.val()&&""===t.$tpicker.val()&&i.timepicker("setTime",new Date(e)),a.dateTimeClearBtnsRefresh(i),a.dateTimeClearBtnsRefresh(s)}};return e},scheduleDatetimeEvents:function(){s("#wpforms-form-locker-schedule-datetime-block").on("change","input",function(e){const t=o.scheduling.start.$dpicker.val(),r=o.scheduling.start.$tpicker.val(),i=o.scheduling.end.$dpicker.val(),s=o.scheduling.end.$tpicker.val();var n,l;""===t||""===i||(l=(t+" "+r).replace(/-/g,"/"),n=(i+" "+s).replace(/-/g,"/"),l=new Date(l),new Date(n).getTime()>l.getTime())||(l.setMinutes(l.getMinutes()+30),o.scheduling.end.$tpicker.timepicker("setTime",l),o.scheduling.end.$dpicker.prop("_flatpickr").setDate(l),a.dateTimeClearBtnsRefresh(o.scheduling.end.$tpicker),a.dateTimeClearBtnsRefresh(o.scheduling.end.$dpicker))})}};return a}(document,(window,jQuery));WPFormsBuilderFormLocker.init();