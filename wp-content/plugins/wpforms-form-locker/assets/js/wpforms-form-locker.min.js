"use strict";const WPFormsFormLocker=window.WPFormsFormLocker||function(f){const l={init:function(){f(l.ready)},ready:function(){l.validation(),l.initNameGroupsValidation()},validation:function(){void 0!==f.fn.validate&&f.validator.addMethod("unique",function(a,n,e,o){o="string"==typeof o&&o||"unique";var t=f(n);const r=t.closest(".wpforms-field"),d=this.previousValue(n,o);let m,s,i,u;return s={action:"wpforms_form_locker_unique_answer",form_id:t.closest(".wpforms-form").data("formid"),field_id:r.data("field-id")},u=n.name,r.hasClass("wpforms-field-name")?(a=l.getCombinedValue(r),u="wpforms[fields]["+s.field_id+"]"):t.hasClass("wpforms-smart-phone-field")&&(u="wpforms[fields]["+s.field_id+"]",a=t.siblings('[name="'+u+'"]').first().val()),s[u]=a,this.settings.messages[n.name]||(this.settings.messages[n.name]={}),d.originalMessage=d.originalMessage||this.settings.messages[n.name][o],this.settings.messages[n.name][o]=d.message,i=f.param(f.extend({data:a},(e="string"==typeof e?{url:e}:e).data)),d.old===i?d.valid:(d.old=i,(m=this).startRequest(n),f.ajax(f.extend(!0,{url:wpforms_form_locker.ajaxurl,type:"post",mode:"abort",port:"validate"+n.name,dataType:"json",data:s,context:m.currentForm,success:function(e){var t,s=!0===e||"true"===e,i=n.name.replace(/(\[[a-z]*\])$/g,"");m.settings.messages[n.name][o]=d.originalMessage,s?(t=m.formSubmitted,m.resetInternals(),m.toHide=m.errorsFor(n),m.formSubmitted=t,(m=l.updateValidatorLists(m,i,r,s)).showErrors()):(t={},e=e||m.defaultMessage(n,{method:o,parameters:a}),t[n.name]=d.message=e,(m=l.updateValidatorLists(m,i,r,s)).showErrors(t)),d.valid=s,m.stopRequest(n,s)}},e)),"pending")},wpforms_settings.val_unique)},initNameGroupsValidation:function(){f(".wpforms-validate").each(function(){var e=f(this),t=e.data("validator");f.extend(t.groups,l.getNameGroups(e))})},getCombinedValue:function(e){const t=[];return e.find("input[data-rule-unique]").each(function(){var e=f(this).val();wpforms.empty(e)||t.push(e)}),t.join(" ")},getNameGroups:function(e){const a={};return e.find(".wpforms-field.wpforms-field-name.wpforms-field-unique").each(function(e){const s=f(this),i=s.attr("id").replace("-container","")+"-field-group";f.each(["first","middle","last"],function(e,t){t=s.find(".wpforms-field-name-"+t).attr("name")||!1;t&&(a[t]=i)})}),a},updateValidatorLists:function(t,s,i,a){return f.each(t.invalid,function(e){e.indexOf(s)<0||(t.invalid[e]=!a,e=i.find('input[name="'+e+'"]'),a&&t.successList.push(e[0]))}),t}};return l}((document,window,jQuery));WPFormsFormLocker.init();